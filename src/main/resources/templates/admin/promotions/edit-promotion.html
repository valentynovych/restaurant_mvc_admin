<!DOCTYPE html>

<html
        lang="en"
        class="light-style layout-navbar-fixed layout-menu-fixed"
        dir="ltr"
        data-theme="theme-default"
        data-assets-path="../../assets/"
        data-template="vertical-menu-template-starter"
        xmlns:th="http://www.thymeleaf.org"
>
<head>
    <meta charset="utf-8"/>
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />

    <title>Редагування товару</title>

    <meta name="description" content=""/>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" th:href="@{/assets/img/favicon/favicon.ico}"/>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link
            href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
            rel="stylesheet"
    />

    <!-- Icons -->
    <link rel="stylesheet" th:href="@{/assets/vendor/fonts/fontawesome.css}"/>
    <link rel="stylesheet" th:href="@{/assets/vendor/fonts/tabler-icons.css}"/>
    <link rel="stylesheet" th:href="@{/assets/vendor/fonts/flag-icons.css}"/>

    <!-- Core CSS -->
    <link rel="stylesheet" th:href="@{/assets/vendor/css/rtl/core.css}"/>
    <link rel="stylesheet" th:href="@{/assets/vendor/css/rtl/theme-default.css}"/>
    <link rel="stylesheet" th:href="@{/assets/css/demo.css}"/>

    <!-- Vendors CSS -->
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}"/>
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/node-waves/node-waves.css}"/>
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/typeahead-js/typeahead.css}"/>
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/animate-css/animate.css}"/>
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/flatpickr/flatpickr.css}"/>
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/select2/select2.css}"/>


    <!-- Page CSS -->

    <!-- Helpers -->
    <script th:src="@{/assets/vendor/js/helpers.js}"></script>

    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script th:src="@{/assets/js/config.js}"></script>
    <script th:src="@{https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js}"></script>
</head>

<body>
<!-- Layout wrapper -->
<div class="layout-wrapper layout-content-navbar">
    <div class="layout-container">
        <!-- Menu -->

        <th:block th:insert="~{fragments/admin-sidebar.html :: sidebar}"></th:block>
        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
            <!-- Navbar -->
            <th:block th:insert="~{fragments/admin-navbar.html :: navbar}"></th:block>
            <!-- / Navbar -->
            <!-- Content wrapper -->
            <div class="content-wrapper">
                <!-- Content -->
                <div class="container-xxl flex-grow-1 container-p-y">
                    <div class="d-flex flex-row justify-content-between align-items-center">
                        <h4 class="fw-bold pt-3">Редагування товару</h4>
                    </div>
                    <div class="card">
                        <form id="promotion-form">
                            <div class="card-body d-flex flex-row gap-5">
                                <div class="ms-5 col-md-4">
                                    <div class="card-header d-flex justify-content-end align-items-center"
                                         style="position: absolute; top: 0; right: 1rem">
                                        <label class="switch switch-success">
                                            <input type="checkbox" class="switch-input" id="isActive"
                                                   name="isActive">
                                            <span class="switch-toggle-slider">
                                        <span class="switch-on">
                                            <i class="ti ti-check"></i>
                                        </span>
                                            <span class="switch-off">
                                                <i class="ti ti-x"></i>
                                            </span>
                                        </span>
                                            <span class="switch-label">Статус</span>
                                        </label>
                                    </div>
                                    <div id="form-header">
                                        <div class="mb-2">
                                            <label class="form-label" for="name">Назва</label>
                                            <input type="text" class="form-control" id="name" name="name"
                                                   placeholder="Назва товару">
                                        </div>
                                        <div class="mb-2">
                                            <label class="form-label" for="promotionType">Тип</label>
                                            <select class="form-select" id="promotionType"
                                                    name="promotionType"></select>
                                        </div>
                                    </div>
                                    <div id="option-type"></div>
                                    <div class="mb-2">
                                        <label class="form-label" for="promotionCondition">Умови акції</label>
                                        <select class="form-select" id="promotionCondition"
                                                name="promotionCondition"></select>
                                    </div>
                                    <div id="option-condition"></div>
                                    <div class="mb-2">
                                        <label class="form-label" for="promoCode">Промокод</label>
                                        <input type="text" class="form-control" id="promoCode" name="promoCode"
                                               placeholder="Промокод для активації">
                                    </div>
                                    <div class="form-check mb-2">
                                        <label class="form-check-label" for="activateOnCode">
                                            Застосувати промокодом
                                        </label>
                                        <input class="form-check-input" type="checkbox" value=""
                                               id="activateOnCode" name="activateOnCode"/>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label" for="description">Опис</label>
                                        <textarea type="text" class="form-control" id="description" name="description"
                                                  placeholder="Опис товару" rows="3"></textarea>
                                    </div>
                                </div>
                                <div class="col-md-4 mt-4">
                                    <div class="d-flex flex-row">
                                        <div>
                                            <label class="text-center ">Головний банер:</label>
                                            <figure class="border-secondary"
                                                    style="border-width: 1px; border-style: solid; width: 300px; height: 240px">
                                                <img src="" id="photo" width="300" height="240">
                                                <input type="hidden" name="photoName" id="photoName">
                                                <input type="file" accept=".png, .jpg, .jpeg" class="input-upload"
                                                       id="photoFile" name="photoFile">
                                            </figure>
                                        </div>
                                        <div class="actions d-flex flex-column gap-2 ms-3" style="margin-top: 5rem">
                                            <label class="btn btn-outline-secondary p-1" for="photoFile">
                                                <i class="ti ti-pencil"></i>
                                            </label>
                                            <label class="btn btn-outline-danger p-1 delete-image-button">
                                                <i class="ti ti-trash-x"></i>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <input type="hidden" id="promotionId" name="id">
                            </div>
                            <div class="card-footer d-flex justify-content-between">
                                <button type="button" class="btn btn-primary save-promotion"
                                        style="margin-left: 15rem;">
                                    Зберегти
                                </button>
                            </div>
                            <div class="card-footer d-flex justify-content-center">

                            </div>
                        </form>
                    </div>
                </div>
                <!-- / Content -->
                <div class="content-backdrop fade"></div>
            </div>
            <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
    </div>
    <!-- Overlay -->
    <div class="layout-overlay layout-menu-toggle"></div>

    <!-- Drag Target Area To SlideIn Menu On Small Screens -->
    <div class="drag-target"></div>
</div>
<!-- / Layout wrapper -->


<!-- Core JS -->
<!-- build:js assets/vendor/js/core.js -->
<script th:src="@{/assets/vendor/libs/jquery/jquery.js}"></script>
<script th:src="@{/assets/vendor/libs/popper/popper.js}"></script>
<script th:src="@{/assets/vendor/js/bootstrap.js}"></script>
<script th:src="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js}"></script>
<script th:src="@{/assets/vendor/libs/node-waves/node-waves.js}"></script>

<script th:src="@{/assets/vendor/libs/hammer/hammer.js}"></script>

<script th:src="@{/assets/vendor/js/menu.js}"></script>
<!-- endbuild -->

<!-- Vendors JS -->
<script th:src="@{/assets/vendor/libs/select2/select2.js}"></script>
<script th:src="@{https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/i18n/uk.min.js}"
        integrity="sha512-TDV/1TfxlJAwv/y8HVjHO/AbxfEi3JzUJhQ9HL8GqMprZTcgRggSavorvX2bYzpWyJLrav/Ub/ikmK1sd3eyTw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script th:src="@{/assets/vendor/libs/autosize/autosize.js}"></script>

<!-- Main JS -->
<script th:src="@{/assets/js/main.js}"></script>

<!-- Page JS -->

<script th:src="@{/assets/vendor/libs/flatpickr/flatpickr.js}"></script>
<script th:src="@{https://npmcdn.com/flatpickr/dist/l10n/uk.js}"></script>
<script th:inline="javascript">
    let src = /*[[@{/assets/img/placeholder-image.png}]]*/ 'default';
    window.onload = function () {
        var images = document.querySelectorAll("img");
        for (var i = 0; i < images.length; i++) {
            if (!images[i].complete || images[i].naturalWidth === 0) {
                images[i].src = src;
            }
        }
    };
</script>

<script th:inline="javascript">
    const fullPath = window.location.pathname;
    const promotionId = Number(fullPath.substring(fullPath.lastIndexOf('/') + 1, fullPath.length));
    var promotionObject;
    const contextPath = /*[[@{/admin/promotions/}]]*/ 'default'

    const $promotionCondition = $('#promotionCondition');
    const $optionCondition = $('#option-condition');

    // inputs for $optionCondition
    const giftProduct = $('<div class="mb-2">\n' +
        '                                        <label class="form-label" for="giftProduct">Товар у подарунок</label>\n' +
        '                                        <select class="form-select select2" id="giftProduct"\n' +
        '                                                name="giftProduct.productId"></select>\n' +
        '                                    </div>\n');
    const discountAmount = $('<div class="mb-2">\n' +
        '                                        <label class="form-label" for="discountAmount">Розмір знижки</label>\n' +
        '                                        <div class="input-group">\n' +
        '                                            <input type="number" class="form-control" id="discountAmount"\n' +
        '                                                   name="discountAmount"\n' +
        '                                                   placeholder="Введіть розмір знижки" aria-describedby="percent">\n' +
        '                                            <span class="input-group-text" id="percent">%</span>\n' +
        '                                        </div>\n' +
        '                                    </div>');
    var minimalAmount = $('<div class="mb-2">\n' +
        '                                        <label class="form-label" for="minimalAmount">Мінімальна сума</label>\n' +
        '                                        <div class="input-group">\n' +
        '                                            <input type="number" class="form-control" id="minimalAmount"\n' +
        '                                                   name="minimalAmount"\n' +
        '                                                   placeholder="Мінімальна сума замовлення" aria-describedby="valute">\n' +
        '                                            <span class="input-group-text" id="valute">грн</span>\n' +
        '                                        </div>\n' +
        '                                    </div>');

    // initialize inputs
    var $promotionType = $('#promotionType');
    $promotionType.select2();
    $promotionCondition.select2()

    if (promotionId) {
        $.ajax({
            type: "GET",
            url: contextPath + 'getPromotion/' + promotionId,
            dataType: "JSON",
            success: function (response) {
                console.log(response);
                promotionObject = response;
                afterLoad();
            },
            error: function (error) {
                $('<div class="alert alert-danger alert-dismissible fade show" role="alert" style="position: absolute; top: 6rem; right: 1rem; z-index: 1100"> \n' +
                    'Ой.. Щось пішло не так :)' +
                    '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>\n' +
                    '</div>').appendTo(".content-wrapper");
                autoCloseAlert();
            }
        });
    } else {
        promotionObject = {
            id: null,
            isActive: false,
            name: null,
            photo: null,
            promotionCondition: "PERCENT_FOR_PRODUCT",
            promotionType: "FOR_PRODUCT",
            discountAmount: null,
            minimalAmount: null,
            promoCode: null,
            activateOnCode: true,
            description: null,
            dateOfCreate: null,
            usedCount: 0
        }
        afterLoad();
    }

    function afterLoad() {
        console.log("afterLoad -> start")
        $promotionType.select2({
            placeholder: 'Тип акції',
            data: [getPromotionTypeLabelByName(promotionObject.promotionType)],
            minimumResultsForSearch: -1,
            ajax: {
                type: "GET",
                url: contextPath + 'getPromotionTypes',
                processResults: function (response) {
                    return {
                        results: $.map(Object.entries(response), function (cat) {
                            return {
                                id: cat[0],
                                text: cat[1]
                            }
                        }),
                    };
                },
                cache: true,
            }
        });

        $promotionType.on('change', function () {
            buildFormHeader(this.value)
        });

        $promotionCondition.select2({
            placeholder: 'Виберіть умови застосування акції',
            data: [getPromotionConditionLabelByName(promotionObject.promotionCondition)],
            minimumResultsForSearch: -1,
            ajax: {
                type: "GET",
                url: contextPath + 'getPromotionConditions',
                processResults: function (response) {
                    return {
                        results: $.map(Object.entries(response), function (cat) {
                            return {
                                id: cat[0],
                                text: cat[1]
                            }
                        }),
                    };
                },
                cache: true,
            }
        });

        $promotionCondition.on('change', function () {
            buildFormBody(this.value)
        })

        console.log("afterLoad -> end")
        buildFormHeader(promotionObject.promotionType);
    }

    function buildFormHeader(promotionType) {
        console.log("buildFormHeader -> start")

        $('#option-type').children().remove();
        switch (promotionType) {
            case 'FOR_PRODUCT':
                $('<div class="mb-2">\n' +
                    '  <label class="form-label" for="forProduct">Акційний товар</label>\n' +
                    '  <select class="form-select select2" id="forProduct"\n' +
                    '          name="forProduct.productId"></select>\n' +
                    '</div>').appendTo('#option-type');
                break;
            case 'FOR_CATEGORY':
                $('<div class="mb-2">\n' +
                    '     <label class="form-label" for="forCategory">Для категорії товарів</label>\n' +
                    '     <select class="form-select" id="forCategory" name="forCategory.id"></select>\n' +
                    '    </div>\n' +
                    '    <div class="mb-2">\n' +
                    '      <label class="form-label" for="subcategory">Підкатегорія</label>\n' +
                    '      <select class="form-select" id="subcategory"\n' +
                    '              name="subcategory.subcategoryId"></select>\n' +
                    '     </div>').appendTo('#option-type');
                break;
        }
        console.log("buildFormHeader -> end")
        buildFormBody(promotionObject.promotionCondition);
    }

    function buildFormBody(promotionCondition) {
        console.log("buildFormBody -> start")

        $optionCondition.children().remove();
        switch (promotionCondition) {
            case 'THIRD_PRODUCT_ON_GIFT':
                $optionCondition.append(giftProduct);
                break;
            case 'PERCENT_FOR_CATEGORY':
                $optionCondition.append(discountAmount);
                break;
            case 'PERCENT_FOR_PRODUCT':
                $optionCondition.append(discountAmount);
                break;
            case 'FIRST_BUY':
                $optionCondition.append(discountAmount);
                break;
            case 'PERCENT_OF_AMOUNT':
                $optionCondition.append(discountAmount);
                $optionCondition.append(minimalAmount);
                break;
            case 'PERCENT_ON_BIRTHDAY':
                $optionCondition.append(discountAmount);
                break;
            case 'FREE_DELIVERY_OF_AMOUNT':
                $optionCondition.append(minimalAmount);
                break;
            default:
                $promotionCondition.focus();
        }
        console.log("buildFormBody -> end")
        fillInputs(promotionObject);
    }

    function fillInputs(promotion) {
        console.log("fillInputs -> start")
        $.fn.select2.defaults.set("language", "uk");

        $('#name').val(promotion.name);
        $('#isActive').prop("checked", promotion.isActive);
        $('#promotionId').val(promotion.id);

        var $forCategory = $('#forCategory');
        if ($forCategory) {
            const forCategoryData = promotion.forCategory ? [{
                id: promotion.forCategory.id,
                text: promotion.forCategory.categoryName
            }] : '';
            $forCategory.select2({
                placeholder: 'Виберіть акційну категорію',
                maximumInputLength: 100,
                data: forCategoryData,
                ajax: {
                    type: "GET",
                    url: contextPath + 'getCategories',
                    data: function (params) {
                        return {
                            search: params.term || '',
                            page: (params.page - 1) || 0
                        };
                    },
                    processResults: function (response) {
                        return {
                            results: $.map(response.content, function (cat) {
                                return {
                                    id: cat.id,
                                    text: cat.categoryName
                                }
                            }),
                            pagination: {
                                more: response.pageable.pageNumber < (response.totalPages - 1)
                            }
                        };
                    },
                    cache: true,
                }
            });
            $forCategory.on('change', function () {
                const categoryId = this.value;
                var $subcategory = $('#subcategory');
                $subcategory.empty();
                $subcategory.select2({
                    placeholder: 'Виберіть категорію продукту',
                    minimumResultsForSearch: -1,
                    ajax: {
                        type: "GET",
                        url: contextPath + 'getSubcategoriesByCategory/' + categoryId,
                        processResults: function (response) {
                            return {
                                results: $.map(response, function (cat) {
                                    return {
                                        id: cat.subcategoryId,
                                        text: cat.subcategoryName
                                    }
                                }),
                            };
                        },
                    }
                });
            })

            const subcategory = promotion.subcategory ? [{
                id: promotion.subcategory.subcategoryId,
                text: promotion.subcategory.subcategoryName
            }] : '';
            $('#subcategory').select2({
                placeholder: 'Виберіть категорію продукту',
                data: subcategory,
                ajax: {
                    type: "GET",
                    url: contextPath + 'getSubcategories',
                    data: function (params) {
                        return {
                            search: params.term || '',
                            page: (params.page - 1) || 0
                        };
                    },
                    processResults: function (response) {
                        return {
                            results: $.map(response.content, function (cat) {
                                return {
                                    id: cat.subcategoryId,
                                    text: cat.subcategoryName
                                }
                            }),
                            pagination: {
                                more: response.pageable.pageNumber < (response.totalPages - 1)
                            }
                        };
                    },
                    cache: true,
                }
            });
        }

        var $giftProduct = $('#giftProduct');
        if ($giftProduct) {
            const giftProductData = promotion.giftProduct ? [{
                id: promotion.giftProduct.productId,
                text: promotion.giftProduct.name
            }] : '';
            $giftProduct.select2({
                placeholder: 'Виберіть подарунковий товар',
                maximumInputLength: 100,
                data: giftProductData,
                ajax: {
                    type: "GET",
                    url: contextPath + 'getProducts',
                    data: function (params) {
                        return {
                            search: params.term || '',
                            page: (params.page - 1) || 0
                        };
                    },
                    processResults: function (response) {
                        console.log(response)
                        return {
                            results: $.map(response.content, function (product) {
                                return {
                                    id: product.productId,
                                    text: product.name
                                }
                            }),
                            pagination: {
                                more: response.pageable.pageNumber < (response.totalPages - 1)
                            }
                        };
                    },
                }
            });
        }


        var $forProduct = $('#forProduct');
        if ($forProduct) {
            const promotionalProductData = promotion.forProduct ? [{
                id: promotion.forProduct.productId,
                text: promotion.forProduct.name
            }] : '';
            $forProduct.select2({
                placeholder: 'Виберіть акційний товар',
                maximumInputLength: 100,
                data: promotionalProductData,
                ajax: {
                    type: "GET",
                    url: contextPath + 'getProducts',
                    data: function (params) {
                        return {
                            search: params.term || '',
                            page: (params.page - 1) || 0
                        };
                    },
                    processResults: function (response) {
                        console.log(response)
                        return {
                            results: $.map(response.content, function (product) {
                                return {
                                    id: product.productId,
                                    text: product.name
                                }
                            }),
                            pagination: {
                                more: response.pageable.pageNumber < (response.totalPages - 1)
                            }
                        };
                    },
                }
            });
        }


        $('#discountAmount').val(promotion.discountAmount);
        $('#minimalAmount').val(promotion.minimalAmount);

        $('#promoCode').val(promotion.promoCode);
        $('#activateOnCode').prop("checked", promotion.activateOnCode);

        var $description = $('#description');
        autosize($description);
        $description.val(promotion.description);

        if (promotion.photo) $("#photo").attr("src", '../../../uploads/' + promotion.photo);
        console.log("fillInputs -> end")
    }

    function getPromotionTypeLabelByName(promotionType) {
        switch (promotionType) {
            case 'FOR_PRODUCT':
                return {
                    id: promotionType,
                    text: 'Для одного товару'
                };
            case 'FOR_CATEGORY':
                return {
                    id: promotionType,
                    text: 'Для категорї товарів'
                };
            default:
                return {
                    id: promotionType,
                    text: 'Невідомий тип акції'
                };
        }
    }

    function getPromotionConditionLabelByName(promotionCondition) {
        switch (promotionCondition) {
            case 'THIRD_PRODUCT_ON_GIFT':
                return {
                    id: promotionCondition,
                    text: 'Третій товар подарунок'
                };
            case 'PERCENT_FOR_CATEGORY':
                return {
                    id: promotionCondition,
                    text: 'Відсоток для категорії'
                };
            case 'PERCENT_FOR_PRODUCT':
                return {
                    id: promotionCondition,
                    text: 'Відсток на продукт'
                };
            case 'FIRST_BUY':
                return {
                    id: promotionCondition,
                    text: 'Перша покупка'
                };
            case 'PERCENT_OF_AMOUNT':
                return {
                    id: promotionCondition,
                    text: 'Відсоток від мінімальної суми'
                };
            case 'PERCENT_ON_BIRTHDAY':
                return {
                    id: promotionCondition,
                    text: 'Відсоток на день народження'
                };
            case 'FREE_DELIVERY_OF_AMOUNT':
                return {
                    id: promotionCondition,
                    text: 'Безкоштовна доставка від суми'
                };
            default:
                return {
                    id: promotionCondition,
                    text: 'Невідомий тип акції'
                };
        }
    }

    $('.save-promotion').on("click", function () {
        var formData = new FormData($('#promotion-form')[0]);
        $('.invalid-feedback').remove();
        $('.is-invalid').removeClass('is-invalid');

        if ($('#isActive').is(":checked")) {
            formData.set("isActive", 'true');
        } else {
            formData.set("isActive", 'false');
        }
        if ($('#activateOnCode').is(":checked")) {
            formData.set("activateOnCode", 'true');
        } else {
            formData.set("activateOnCode", 'false');
        }


        // for (const dat of formData.entries()) {
        //     console.log(dat)
        // }

        const postPath = promotionId ? 'update-promotion' : 'add-promotion'
        $.ajax({
            type: "POST",
            url: contextPath + postPath,
            data: formData,
            processData: false,
            contentType: false,
            success: function (response) {
                $('<div class="alert alert-success alert-dismissible fade show" role="alert" style="position: absolute; top: 6rem; right: 1rem; z-index: 1150"> \n' +
                    'Оновлення успішне !' +
                    '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>\n' +
                    '</div>').appendTo(".content-wrapper");
                promotionObject = response;
                autoCloseAlert();
            },
            error: function (error) {
                console.log('error')
                const errors = error.responseJSON;
                for (let error of errors) {
                    $(document).find("select[name='" + error.field + "'], input[name='" + error.field + "']").addClass("is-invalid").parent().append($(
                        '<p class="error-message invalid-feedback m-0">' + error.defaultMessage + '</p>'
                    ))
                }
                $('<div class="alert alert-danger alert-dismissible fade show" role="alert" style="position: absolute; top: 6rem; right: 1rem"> \n' +
                    'Ой.. Щось пішло не так :)' +
                    '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>\n' +
                    '</div>').appendTo(".content-wrapper");
                autoCloseAlert();
            }
        })
    });

    $("#photoFile").on("change", previewImage);

    function previewImage() {
        if (this.files && this.files[0]) {
            const type = this.files[0].type;
            const reader = new FileReader();
            reader.onload = function (e) {
                if (type === "image/jpeg" || type === "image/jpg" || type === "image/png") {
                    $("#photo").attr("src", e.target.result);
                } else {
                    $("#photo").addClass("is-invalid")
                        .after($('<p class="error-message text-center text-danger m-0">' +
                            'Вибраний файл не є зображенням у форматі jpeg, jpg або png.</p>'
                        ))
                }
            };
            reader.readAsDataURL(this.files[0]);
        }
    }

    function autoCloseAlert() {
        $(".alert").fadeTo(2000, 500).slideUp(500, function () {
            $("#success-alert").slideUp(500);
        });
    }

</script>
</body>
</html>
